@using System.Security.Claims
@using ReviewEverything.Shared.Contracts.Responses
<AuthorizeView Policy="Admin">
    <Authorized>
        <MudDivider />
        <MudListItem Text="Панель управления">
            <NestedList>
                <MudListItem Href="./admin/category" OnClick="MainLayout.ChangeDrawerOpen">Категории</MudListItem>
            </NestedList>
        </MudListItem>
    </Authorized>
</AuthorizeView>
<MudDivider />
<AuthorizeView>
    <Authorized>
        <MudListItem Text="Аккаунт">
            <NestedList>
                <MudListItem Text="Моя страница" OnClick="MainLayout.ChangeDrawerOpen" Href="@($"./user/{context.User.Claims.First(claim => claim.Type == ClaimTypes.NameIdentifier).Value}")" />
                <MudListItem Text="Настройки" OnClick="MainLayout.ChangeDrawerOpen" />
            </NestedList>
        </MudListItem>
    </Authorized>
</AuthorizeView>
<MudDivider />
<MudListItem Text="Категории" InitiallyExpanded="true">
    <NestedList>
        @if (Categories != null)
        {
            foreach (var category in Categories)
            {
                <MudListItem OnClick="MainLayout.ChangeDrawerOpen" Text="@category.Title" />
            }
        }
    </NestedList>
</MudListItem>

@code
{
    [CascadingParameter] private List<CategoryResponse> Categories { get; set; } = default!;
    [CascadingParameter] private MainLayout MainLayout { get; set; } = default!;

}
